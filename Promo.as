package  {		import flash.display.MovieClip	import flash.events.MouseEvent;	import flash.events.TouchEvent;	import flash.ui.Multitouch;	import flash.ui.MultitouchInputMode;	import flash.events.Event;	import flash.events.ErrorEvent	import flash.events.IOErrorEvent	import flash.events.Event;	import com.greensock.TweenLite;	import com.greensock.TweenMax;	import com.greensock.*;	import com.greensock.easing.*;	import flash.media.Sound	import flash.net.URLLoader	import flash.net.URLRequest	import flash.net.URLRequestMethod	import flash.net.URLVariables	import flash.net.navigateToURL	import flash.desktop.NativeApplication	import flash.display.Loader;	import flash.system.Capabilities;			public class Promo extends MovieClip {		private var spawn:Mainmenu		private var mymain:Main		private var imageLoader:Loader // loading the promo png or swf		private var settingsloader:URLLoader // loading the promosettings object		private var moregamesloaded:Boolean=false		public var promoSettings:Object		public function Promo(inSpawn:Mainmenu) {			trace("new promo")			spawn = inSpawn			mymain = spawn.mymain			inSpawn.addChild(this)						createLoaders()			NativeApplication.nativeApplication.addEventListener(Event.ACTIVATE,onActivate)			checkPromoSettings()		}		private function createLoaders() {			trace("in createLoaders")						settingsloader = new URLLoader();			settingsloader.addEventListener(Event.COMPLETE, onCheckComplete);			settingsloader.addEventListener(ErrorEvent.ERROR, onLoadError);			settingsloader.addEventListener(IOErrorEvent.IO_ERROR, onLoadError);			imageLoader = new Loader()			imageLoader.contentLoaderInfo.addEventListener(Event.COMPLETE,onLoadComplete)			imageLoader.contentLoaderInfo.addEventListener(ErrorEvent.ERROR,onLoadError)			imageLoader.contentLoaderInfo.addEventListener(IOErrorEvent.IO_ERROR,onLoadError)			this.addChild(imageLoader)			imageLoader.addEventListener(MouseEvent.CLICK,onMoreGamesClick)		}		private function onActivate(e:Event) {			trace("onActivate")			checkPromoSettings()		}				private function checkPromoSettings() {			trace("checking more promoSettings")										var obj = new Object()			obj.appname = "rosalyn's horse coloring"			obj.screenwidth = mymain.stage.fullScreenWidth			obj.screenheight = mymain.stage.fullScreenHeight			obj.payinguser = mymain.payingUser			obj.numplays = mymain.numPlays			obj.appversion = mymain.appversion			obj.os = Capabilities.os						var jasonObject = JSON.stringify(obj)			trace(jasonObject)			var urlvars:URLVariables = new URLVariables()			urlvars.userdata = jasonObject  // use userdata in PHP $_POST['userdata'] 			var req:URLRequest = new URLRequest()			req.data = urlvars			req.url = "http://www.wungi.com/moregames/check.php"			req.method = URLRequestMethod.POST						settingsloader.load(req);		}				private function onCheckComplete(e:Event) {			//properties are active, clickurl and imageurl			trace("in onCheckComplete")			promoSettings = JSON.parse(e.target.data)			showPromo()					}						private function showPromo() {			trace("in showPromo")			if (promoSettings.active) {				imageLoader.visible = true				imageLoader.load(new URLRequest(promoSettings.imageurl))			}			else imageLoader.visible = false		}				private function onLoadError(e:Event) {			mymain.console.log("error downloading moregames promo")			imageLoader.visible = false		}				private function onLoadComplete(e:Event) {			imageLoader.visible = true			imageLoader.x = (mymain.stage.fullScreenWidth - imageLoader.width)/2   //center			TweenMax.from(imageLoader,1,{y:"-100"})		}				private function onMoreGamesClick(e:Event) {			if (promoSettings.clickurl) {				var req:URLRequest = new URLRequest(promoSettings.clickurl)				navigateToURL(req,"_blank")			}		}	}	}